Sub DedubeTransferOldData()
    'http://www.rondebruin.nl/ado.htm
    start_time = Now()
    
    Dim szConnect As String
    Dim szSQL As String
    
    'Late-bind the ADODB objects we need ;)
    Set rsCon = CreateObject("ADODB.Connection")
    Set rsData = CreateObject("ADODB.Recordset")
    
    szConnect = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Temp\temp_test\workbook_b.xlsx;Extended Properties=""Excel 12.0 Xml;HDR=Yes"""
    rsCon.Open szConnect
    
    Set rs = rsCon.OpenSchema(20)  '20 =adSchemaTables
    
    While Not rs.EOF
        'GetSchema = GetSchema & IIf(Trim(GetSchema) = "", "", ",") & rs("TABLE_NAME")
        Debug.Print rs("TABLE_NAME")
        rs.MoveNext
    Wend
    
    rs.Close
    
    szSQL = "SELECT * FROM [Dedupe$];"
    rsData.Open szSQL, rsCon, 0, 1, 1
    
    'Check to make sure we received data and copy the data
    If rsData.EOF Then
        MsgBox "Workbook has reached EOF. Is there any data in this workbook?", vbExclamation
        Exit Sub
    End If
    
    'Headers we need present on the loaded workbook
    Dim neededHeaders As Variant
    neededHeaders = Array("CORP", "HOUSE", "CUST", "COMMENTS", "DATE", "ANALYST")
    
    'Let's search the headers in the loaded workbook.
    For Each Header In neededHeaders
        For Each field In rsData.Fields
            If UCase(Trim(Header)) = UCase(Trim(field.Name)) Then
                Exit For
            ElseIf UCase(Trim(field.Name)) = UCase(Trim(rsData.Fields(rsData.Fields.Count - 1).Name)) Then
                'There's one header missing from the loaded file and we've reached the end of the search...
                MsgBox "Unable to find the Header """ & Header & """ in the loaded workbook. Make sure the appropriate headers are available on the workbook you are loading.", vbExclamation
                Stop
            End If
        Next field
    Next Header
    
    'Trim up our cells on the active worksheet for perfect compatability with the Find() function... more to learn on it...
    For i = 1 To Cells(1, Columns.Count).End(xlToLeft).Column
        Cells(1, i) = Trim(Cells(1, i))
    Next i
    
    lastRow = Cells(Rows.Count, Rows(1).Find("HOUSE", lookAt:=xlWhole).Column).End(xlUp).Row
    
    'At this point, Headers on the loaded workbook are 100% there. Bring over COMMENTS, DATE, & ANALYST from old file now
    'This single statement will return the row the found item is in'
    
    While Not rsData.EOF Or lastRow = 0
        searchVal = Trim(rsData.Fields("CORP")) & Trim(rsData.Fields("HOUSE")) & Trim(rsData.Fields("CUST"))
        If Not Columns(Rows(1).Find("CORP_HOUSE_CUST", lookAt:=xlWhole).Column).Find(searchVal, lookAt:=xlWhole) Is Nothing Then
            With Columns(Rows(1).Find("CORP_HOUSE_CUST", lookAt:=xlWhole).Column)
                Cells(.Find(searchVal, lookAt:=xlWhole).Row, Rows(1).Find("COMMENTS", lookAt:=xlWhole).Column) = rsData.Fields("COMMENTS")
                Cells(.Find(searchVal, lookAt:=xlWhole).Row, Rows(1).Find("DATE", lookAt:=xlWhole).Column) = rsData.Fields("DATE")
                Cells(.Find(searchVal, lookAt:=xlWhole).Row, Rows(1).Find("ANALYST", lookAt:=xlWhole).Column) = rsData.Fields("ANALYST")
            End With
        End If
        
        lastRow = lastRow - 1
        Application.StatusBar = "Records to go: " & lastRow
        rsData.MoveNext
    Wend
    
    'rsData.fields("CORP") & rsData.fields("HOUSE") & rsData.fields("CUST")
    'Dim varArr As Variant
    'Dump the data into my variant!
    'varArr = rsData.GetRows
    'Not necessary to dump to an array... you can navigate fields itself and copy over the matched results... but no headers...
    'Nevermind... got it: rsData.Fields(3).Name is [CORP]
    
    'Clean up our Recordset object.
    rsData.Close
    Set rsData = Nothing
    rsCon.Close
    Set rsCon = Nothing
    
    'Erase our array
    'Erase varArr
    
    'Next steps are to sort the current worksheet by CORP_HOUSE_CUST and start entering all data from varArr()
    
    End_time = Now()
    
    MsgBox "Dedup transfer completed in: " & Format(End_time - start_time, "hh:mm:ss")
    
    Stop
End Sub
